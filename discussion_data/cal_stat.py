from scipy.stats import mannwhitneyu


sample_RM = [0.155831566192063, 0.15589215389275976, 0.15734625870948196, 0.15831566192063012, 0.16061799454710693,
             0.16073916994850046, 0.16340502877915783, 0.16485913359588003, 0.16601029990911845, 0.1713420175704332]
sample_our = [0.31269312329597093, 0.31148136928203574, 0.3117843077855195, 0.31111784307785517, 0.31136019388064223,
              0.31220842169039686, 0.311420781581339, 0.31220842169039686, 0.3117237200848228, 0.31232959709179037]
sample_RS = [0.31129960617994545, 0.3122690093910936, 0.31129960617994545, 0.31093607997576495, 0.31105725537715845,
             0.31129960617994545, 0.3088155104513784, 0.3117237200848228, 0.31136019388064223, 0.3130566495001515]
sample_RP = [
    0.3105119660708876, 0.31105725537715845, 0.30930021205695246, 0.3105119660708876, 0.3105119660708876,
    0.31002726446531353, 0.3094819751590427, 0.31117843077855195] + [0.31160254468342924, 0.3105119660708876]
cp910_covs = [
    0.2545895183277795, 0.2555589215389276, 0.25531657073614056, 0.2556800969403211, 0.25392305362011514,
    0.2551348076340503, 0.25574068464101785, 0.25531657073614056, 0.2558012723417146] + [0.26566400399400897]
Smith_covs = [
    0.21054225992123599, 0.21029990911844895, 0.20987579521357164, 0.21029990911844895, 0.21017873371705545,
    0.21005755831566192, 0.2103604968191457, 0.2102393214177522, 0.21042108451984248, 0.21005755831566192]



def vargha_delaney_effect_size(sample1, sample2):
    n1 = len(sample1)
    n2 = len(sample2)
    u_statistic, _ = mannwhitneyu(sample1, sample2, alternative='two-sided')
    A = u_statistic / (n1 * n2)
    return A


def get_p_value(sample1, sample2):
    _, p_value = mannwhitneyu(sample1, sample2, alternative='two-sided')
    return p_value


def mean(sample):
    return sum(sample) / len(sample)

# check num
assert len(sample_RS) == 10
assert len(sample_our) == 10
assert len(sample_RP) == 10
assert len(cp910_covs) == 10
assert len(Smith_covs) == 10
assert len(sample_RM) == 10


name2data = {
    'RS': sample_RS,
    'RP': sample_RP,
    'CP910': cp910_covs,
    'Smith': Smith_covs,
    'RM': sample_RM
}


for name, data in name2data.items():
    cov = mean(data)
    p_value = get_p_value(sample_our, data)
    effect_size = vargha_delaney_effect_size(sample_our, data)
    print(f'{name} cov: {cov}, p_value: {p_value}, effect_size: {effect_size}')
print('Our Cov:', mean(sample_our))

